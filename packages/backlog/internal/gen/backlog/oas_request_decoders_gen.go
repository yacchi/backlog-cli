// Code generated by ogen, DO NOT EDIT.

package backlog

import (
	"mime"
	"net/http"

	"github.com/go-faster/errors"
	"github.com/ogen-go/ogen/conv"
	ht "github.com/ogen-go/ogen/http"
	"github.com/ogen-go/ogen/uri"
	"github.com/ogen-go/ogen/validate"
)

func (s *Server) decodeAddCommentRequest(r *http.Request) (
	req OptAddCommentReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptAddCommentReq
		{
			var optForm AddCommentReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "content",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToString(val)
						if err != nil {
							return err
						}

						optForm.Content = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"content\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "notifiedUserId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotNotifiedUserIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotNotifiedUserIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.NotifiedUserId = append(optForm.NotifiedUserId, optFormDotNotifiedUserIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"notifiedUserId\"")
					}
				}
			}
			request = OptAddCommentReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}

func (s *Server) decodeCreateCategoryRequest(r *http.Request) (
	req OptCreateCategoryReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptCreateCategoryReq
		{
			var optForm CreateCategoryReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "name",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToString(val)
						if err != nil {
							return err
						}

						optForm.Name = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"name\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			request = OptCreateCategoryReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}

func (s *Server) decodeCreateIssueRequest(r *http.Request) (
	req OptCreateIssueReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptCreateIssueReq
		{
			var optForm CreateIssueReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "projectId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToInt(val)
						if err != nil {
							return err
						}

						optForm.ProjectId = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"projectId\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "summary",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToString(val)
						if err != nil {
							return err
						}

						optForm.Summary = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"summary\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "issueTypeId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToInt(val)
						if err != nil {
							return err
						}

						optForm.IssueTypeId = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"issueTypeId\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "priorityId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToInt(val)
						if err != nil {
							return err
						}

						optForm.PriorityId = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"priorityId\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "description",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotDescriptionVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotDescriptionVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Description.SetTo(optFormDotDescriptionVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"description\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "startDate",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotStartDateVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotStartDateVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.StartDate.SetTo(optFormDotStartDateVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"startDate\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "dueDate",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotDueDateVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotDueDateVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.DueDate.SetTo(optFormDotDueDateVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"dueDate\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "estimatedHours",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotEstimatedHoursVal float64
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToFloat64(val)
							if err != nil {
								return err
							}

							optFormDotEstimatedHoursVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.EstimatedHours.SetTo(optFormDotEstimatedHoursVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"estimatedHours\"")
					}
					if err := func() error {
						if value, ok := optForm.EstimatedHours.Get(); ok {
							if err := func() error {
								if err := (validate.Float{}).Validate(float64(value)); err != nil {
									return errors.Wrap(err, "float")
								}
								return nil
							}(); err != nil {
								return err
							}
						}
						return nil
					}(); err != nil {
						return req, rawBody, close, errors.Wrap(err, "validate")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "actualHours",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotActualHoursVal float64
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToFloat64(val)
							if err != nil {
								return err
							}

							optFormDotActualHoursVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.ActualHours.SetTo(optFormDotActualHoursVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"actualHours\"")
					}
					if err := func() error {
						if value, ok := optForm.ActualHours.Get(); ok {
							if err := func() error {
								if err := (validate.Float{}).Validate(float64(value)); err != nil {
									return errors.Wrap(err, "float")
								}
								return nil
							}(); err != nil {
								return err
							}
						}
						return nil
					}(); err != nil {
						return req, rawBody, close, errors.Wrap(err, "validate")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "categoryId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotCategoryIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotCategoryIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.CategoryId = append(optForm.CategoryId, optFormDotCategoryIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"categoryId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "versionId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotVersionIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotVersionIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.VersionId = append(optForm.VersionId, optFormDotVersionIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"versionId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "milestoneId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotMilestoneIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotMilestoneIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.MilestoneId = append(optForm.MilestoneId, optFormDotMilestoneIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"milestoneId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "assigneeId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotAssigneeIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotAssigneeIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.AssigneeId.SetTo(optFormDotAssigneeIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"assigneeId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "parentIssueId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotParentIssueIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotParentIssueIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.ParentIssueId.SetTo(optFormDotParentIssueIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"parentIssueId\"")
					}
				}
			}
			request = OptCreateIssueReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}

func (s *Server) decodeCreateWikiRequest(r *http.Request) (
	req OptCreateWikiReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptCreateWikiReq
		{
			var optForm CreateWikiReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "projectId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToInt(val)
						if err != nil {
							return err
						}

						optForm.ProjectId = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"projectId\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "name",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToString(val)
						if err != nil {
							return err
						}

						optForm.Name = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"name\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "content",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						val, err := d.DecodeValue()
						if err != nil {
							return err
						}

						c, err := conv.ToString(val)
						if err != nil {
							return err
						}

						optForm.Content = c
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"content\"")
					}
				} else {
					return req, rawBody, close, errors.Wrap(err, "query")
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "mailNotify",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotMailNotifyVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotMailNotifyVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.MailNotify.SetTo(optFormDotMailNotifyVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"mailNotify\"")
					}
				}
			}
			request = OptCreateWikiReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}

func (s *Server) decodeUpdateCommentRequest(r *http.Request) (
	req OptUpdateCommentReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptUpdateCommentReq
		{
			var optForm UpdateCommentReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "content",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotContentVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotContentVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Content.SetTo(optFormDotContentVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"content\"")
					}
				}
			}
			request = OptUpdateCommentReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}

func (s *Server) decodeUpdateIssueRequest(r *http.Request) (
	req OptUpdateIssueReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptUpdateIssueReq
		{
			var optForm UpdateIssueReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "summary",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotSummaryVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotSummaryVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Summary.SetTo(optFormDotSummaryVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"summary\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "description",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotDescriptionVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotDescriptionVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Description.SetTo(optFormDotDescriptionVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"description\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "statusId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotStatusIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotStatusIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.StatusId.SetTo(optFormDotStatusIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"statusId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "resolutionId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotResolutionIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotResolutionIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.ResolutionId.SetTo(optFormDotResolutionIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"resolutionId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "priorityId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotPriorityIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotPriorityIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.PriorityId.SetTo(optFormDotPriorityIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"priorityId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "issueTypeId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotIssueTypeIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotIssueTypeIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.IssueTypeId.SetTo(optFormDotIssueTypeIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"issueTypeId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "startDate",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotStartDateVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotStartDateVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.StartDate.SetTo(optFormDotStartDateVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"startDate\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "dueDate",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotDueDateVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotDueDateVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.DueDate.SetTo(optFormDotDueDateVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"dueDate\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "estimatedHours",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotEstimatedHoursVal float64
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToFloat64(val)
							if err != nil {
								return err
							}

							optFormDotEstimatedHoursVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.EstimatedHours.SetTo(optFormDotEstimatedHoursVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"estimatedHours\"")
					}
					if err := func() error {
						if value, ok := optForm.EstimatedHours.Get(); ok {
							if err := func() error {
								if err := (validate.Float{}).Validate(float64(value)); err != nil {
									return errors.Wrap(err, "float")
								}
								return nil
							}(); err != nil {
								return err
							}
						}
						return nil
					}(); err != nil {
						return req, rawBody, close, errors.Wrap(err, "validate")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "actualHours",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotActualHoursVal float64
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToFloat64(val)
							if err != nil {
								return err
							}

							optFormDotActualHoursVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.ActualHours.SetTo(optFormDotActualHoursVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"actualHours\"")
					}
					if err := func() error {
						if value, ok := optForm.ActualHours.Get(); ok {
							if err := func() error {
								if err := (validate.Float{}).Validate(float64(value)); err != nil {
									return errors.Wrap(err, "float")
								}
								return nil
							}(); err != nil {
								return err
							}
						}
						return nil
					}(); err != nil {
						return req, rawBody, close, errors.Wrap(err, "validate")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "assigneeId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotAssigneeIdVal int
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToInt(val)
							if err != nil {
								return err
							}

							optFormDotAssigneeIdVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.AssigneeId.SetTo(optFormDotAssigneeIdVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"assigneeId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "categoryId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotCategoryIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotCategoryIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.CategoryId = append(optForm.CategoryId, optFormDotCategoryIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"categoryId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "versionId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotVersionIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotVersionIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.VersionId = append(optForm.VersionId, optFormDotVersionIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"versionId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "milestoneId",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						return d.DecodeArray(func(d uri.Decoder) error {
							var optFormDotMilestoneIdVal int
							if err := func() error {
								val, err := d.DecodeValue()
								if err != nil {
									return err
								}

								c, err := conv.ToInt(val)
								if err != nil {
									return err
								}

								optFormDotMilestoneIdVal = c
								return nil
							}(); err != nil {
								return err
							}
							optForm.MilestoneId = append(optForm.MilestoneId, optFormDotMilestoneIdVal)
							return nil
						})
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"milestoneId\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "comment",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotCommentVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotCommentVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Comment.SetTo(optFormDotCommentVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"comment\"")
					}
				}
			}
			request = OptUpdateIssueReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}

func (s *Server) decodeUpdateWikiRequest(r *http.Request) (
	req OptUpdateWikiReq,
	rawBody []byte,
	close func() error,
	rerr error,
) {
	var closers []func() error
	close = func() error {
		var merr error
		// Close in reverse order, to match defer behavior.
		for i := len(closers) - 1; i >= 0; i-- {
			c := closers[i]
			merr = errors.Join(merr, c())
		}
		return merr
	}
	defer func() {
		if rerr != nil {
			rerr = errors.Join(rerr, close())
		}
	}()
	if _, ok := r.Header["Content-Type"]; !ok && r.ContentLength == 0 {
		return req, rawBody, close, nil
	}
	ct, _, err := mime.ParseMediaType(r.Header.Get("Content-Type"))
	if err != nil {
		return req, rawBody, close, errors.Wrap(err, "parse media type")
	}
	switch {
	case ct == "application/x-www-form-urlencoded":
		if r.ContentLength == 0 {
			return req, rawBody, close, nil
		}
		form, err := ht.ParseForm(r)
		if err != nil {
			return req, rawBody, close, errors.Wrap(err, "parse form")
		}

		var request OptUpdateWikiReq
		{
			var optForm UpdateWikiReq
			q := uri.NewQueryDecoder(form)
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "name",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotNameVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotNameVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Name.SetTo(optFormDotNameVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"name\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "content",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotContentVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotContentVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.Content.SetTo(optFormDotContentVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"content\"")
					}
				}
			}
			{
				cfg := uri.QueryParameterDecodingConfig{
					Name:    "mailNotify",
					Style:   uri.QueryStyleForm,
					Explode: true,
				}
				if err := q.HasParam(cfg); err == nil {
					if err := q.DecodeParam(cfg, func(d uri.Decoder) error {
						var optFormDotMailNotifyVal string
						if err := func() error {
							val, err := d.DecodeValue()
							if err != nil {
								return err
							}

							c, err := conv.ToString(val)
							if err != nil {
								return err
							}

							optFormDotMailNotifyVal = c
							return nil
						}(); err != nil {
							return err
						}
						optForm.MailNotify.SetTo(optFormDotMailNotifyVal)
						return nil
					}); err != nil {
						return req, rawBody, close, errors.Wrap(err, "decode \"mailNotify\"")
					}
				}
			}
			request = OptUpdateWikiReq{
				Value: optForm,
				Set:   true,
			}
		}
		return request, rawBody, close, nil
	default:
		return req, rawBody, close, validate.InvalidContentType(ct)
	}
}
